<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="/logo01.svg">
<title>Spacesurf Articles</title>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400&display=swap" rel="stylesheet">
<link href="assets/css/bootstrap.min.css" rel="stylesheet">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
<link href="/articles/style.css" rel="stylesheet">

</head>

<body>

<!-- Begin Nav
================================================== -->
<nav class="navbar navbar-toggleable-md navbar-light bg-white fixed-top mediumnavigation">

<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>

</button>

<div class="container">
	<!-- Begin Logo -->
	<a class="navbar-brand" href="index.html">

	<img src="/logo01.svg" alt="logo">

	</a>
	<!-- End Logo -->
	<div class="collapse navbar-collapse" id="navbarsExampleDefault">
		<!-- Begin Menu -->
		<ul class="navbar-nav ml-auto">

			<li class="nav-item active">
			<a class="nav-link" href="index.html">Home<span class="sr-only">(current)</span></a>

			</li>
			<li class="nav-item">

			<a class="nav-link" href="">Cyber Security</a>
			</li>

			<li class="nav-item">
			<a class="nav-link" href="https://www.instagram.com/naga_sai_kumar_varikuti/">Author</a>

			</li>
		</ul>

	</div>

</div>

</nav>

<style>
	body, html, h1, h2, p{
		font-family: Poppins;
    align-items: center;
	}
</style>

<div class="container">

	<div class="row">

		<div class="col-md-2 col-xs-12">
			<div class="share">

</div>

		</div>

		<div class="col-md-8 col-md-offset-2 col-xs-12">
			<div class="mainheading">

				<!-- Begin Top Meta -->
				<div class="row post-top-meta">
					
					<div class="col-md-10">
						
						
						<span class="post-date">22 July 2017</span><span class="dot"></span><span class="post-read">6 min read</span>
					</div>
				</div>
				<!-- End Top Menta -->

				<h1 class="posttitle">LOCAL FILE INCLUSION</h1>

			</div>

			<!-- Begin Featured Image -->
			<img class="featured-image img-fluid" src="/images/image.png" alt="logo" style="width:130rm">
			<!-- End Featured Image -->

			<!-- Begin Post Content -->
			<div class="article-post">
				<p>
					Alright lets get started<br></br>Local file inclusion(LFI) It is an most common vulnerability that can be seen in web applications, In this blog we can see how to find them and how to prevent them. 
				</p>
        
				<p>
          local file inclusion is a kind of vulnerability that exposes the files running on the web server so that LFI comes under information disclosure with the severity: High.<br></br> It's impacks can differ on what information they can access through LFI we can gather usernames of users on that particular webserver and harvest the passwords and harvest usefull inforamation from webserver logs and we can convert simple LFI into remote code execution by combining this vulnerability with some attacks vector such of upload vulneraility, log injection, or from The /proc/self/environ file  
				</p>
        <p><b>how to identify LFI?</b></p>
        <p>
          we can identify LFI through some online tools or basic penetration testing which takes alot of time and resources so i recomand using online tools like nessus
        </p>
        <p>The source code of application that is vulnerable to LFI may look like below 
        </p>
        <img src="/images/code.png" alt="#code">
				<p>
					 LFI vulnerability occures when an application uses the path to a file as input as shown above code. If the application treats that input as trusted a local file may be used in the included statement and the url to LFI may look like below
				</p>
        <p><b style="text-center">Eg: www.something.com/script.php?file=index.php</b></p>
        <blockquote>
					If you something like above in any website its worth a try, 
				</blockquote>
        

        <p>
          <b>Attacking LFI</b>
        </p>

				<p>
					Any one can exploit by manipulating the file location parameter, we can put any file location which we want to read we can read /etc/passwd like as shown below<br></br>
          <b>Eg: www.something.com/script.php?file=../../../../../etc/passwd</b><br></br>
           if we can access /etc/passwd file we can gather uesrnames and start hydra password bruitforce or we can access all the server log file and gather usernames and password
				</p>

        <p>
          <b>Converting LFI to RCE</b><br></br>
          we can convert LFI to rce using many techniques like php_expect_wrapper, The /proc/self/environ file, file upload form<br></br>
          php expect wrapper:<br></br>php <b>expect://</b> allows us to execute system commands and we do that by placing <b>php?file=expect://ls</b>This will send post request to server to execute the ls command and it will list the files on the server. we can put a bash reverse shell in the the url and send the packet to server and the exectution of that command gives us reverse shell on the server
        </p>

        <p>
          File upload Form:<br></br>if there is a file upload form we can upload php reverse shell or bash reverse shell and we can execute it using LFI and get a reverse shell
        </p>

        <p>
          The /proc/self/environ file:<br></br>If we can intercept /proc/self/environ file we can made some change to it and make it execute the bash revershell. The changes are once we intersepted environ file we should should change the <b>User-Agent</b> to simple php command shell, once code is injected send the packet and refresh and then send the command like <b>php?file=/proc/self/environ&cmd=ls</b>this will cause the server to show the files on server we can send bash reverseshell command and get a shell on server
        </p>

			</div>
			<!-- End Post Content -->

			<!-- Begin Tags 
			<div class="after-post-tags">
				<ul class="tags">
					<li><a href="#">Design</a></li>
					<li><a href="#">Growth Mindset</a></li>
					<li><a href="#">Productivity</a></li>
					<li><a href="#">Personal Growth</a></li>
				</ul>
			</div>
			 End Tags -->

		</div>
		<!-- End Post -->

	</div>
</div>


<div class="hideshare"></div>

<!--<div class="alertbar">
	<div class="container text-center">
		<img src="assets/img/logo.png" alt=""> &nbsp; Never miss a <b>story</b> from us, get weekly updates in your inbox. <a href="#" class="btn subscribe">Get Updates</a>
	</div>
</div>-->

<div class="container">
	<div class="footer">
		<p class="pull-left">
			 record number, month and date
		</p>
		
		</p>
		<div class="clearfix">
		</div>
	</div>
</div>



<script src="assets/js/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/ie10-viewport-bug-workaround.js"></script>
<script src="assets/js/mediumish.js"></script>
</body>
</html>
